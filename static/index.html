<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eventbrite Clone - Events Dashboard</title>
    <!-- Google Fonts for Modern Typography -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Vanilla CSS -->
    <link rel="stylesheet" href="/static/styles.css">
</head>

<body>
    <div id="toast-container"></div>

    <nav class="navbar">
        <div class="logo">üéüÔ∏è EventRegistration</div>
        <div class="nav-links" id="nav-actions">
            <!-- Will be populated by JS -->
        </div>
    </nav>

    <main class="container">
        <!-- Auth Section -->
        <section id="auth-section" class="card">
            <div class="auth-header">
                <h2>Welcome</h2>
                <p>Log in or sign up to discover events.</p>
            </div>

            <div class="tabs">
                <button class="tab-btn active" onclick="switchTab(event, 'login')">Login</button>
                <button class="tab-btn" onclick="switchTab(event, 'register')">Register</button>
            </div>

            <form id="login-form" class="auth-form active-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="login-email" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="login-pwd" required>
                </div>
                <button type="submit" class="btn btn-primary">Log In</button>
            </form>

            <form id="register-form" class="auth-form" onsubmit="handleRegister(event)">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="reg-name" required>
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="reg-email" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="reg-pwd" minlength="6" required>
                </div>
                <div class="form-group">
                    <label>Account Type</label>
                    <select id="reg-role">
                        <option value="AUDIENCE">Audience</option>
                        <option value="ORGANIZER">Organizer</option>
                        <option value="ADMIN">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Create Account</button>
            </form>
        </section>

        <!-- Main Dashboard Section -->
        <section id="dashboard-section" class="hidden">

            <header class="section-header">
                <h2>Live Events</h2>
                <div class="admin-actions" id="admin-actions">
                    <!-- Setup in JS based on role -->
                </div>
            </header>

            <div id="events-grid" class="grid">
                <!-- Event cards populated here -->
            </div>

            <!-- Organizer Dashboard / Creation -->
            <div id="organizer-panel" class="hidden">
                <header class="section-header">
                    <h2>Create New Event</h2>
                </header>

                <form id="create-event-form" class="card" onsubmit="handleCreateEvent(event)"
                    style="margin-bottom: 4rem;">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Event Title</label>
                            <input type="text" id="ev-title" required>
                        </div>
                        <div class="form-group">
                            <label>Event Date</label>
                            <input type="date" id="ev-date" required>
                        </div>
                    </div>
                    <div class="form-group" style="margin-top: 1.25rem;">
                        <label>Event Description</label>
                        <textarea id="ev-desc" rows="3"></textarea>
                    </div>
                    <div class="form-row" style="margin-top: 1.25rem;">
                        <div class="form-group">
                            <label>Location</label>
                            <input type="text" id="ev-location">
                        </div>
                        <div class="form-group">
                            <label>Capacity</label>
                            <input type="number" id="ev-capacity" min="1" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" style="margin-top: 2rem;">Create & Publish
                        Event</button>
                </form>

                <header class="section-header">
                    <h2>My Organized Events</h2>
                </header>
                <div id="my-events-grid" class="grid">
                    <!-- Events the organizer created -->
                </div>
            </div>

        </section>

        <!-- Simulation Admin Modal -->
        <div id="sim-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close-btn" onclick="closeSimModal()">&times;</span>
                <h2>‚ö° Concurrency Stress Test</h2>
                <p>Spawns N concurrent Goroutines to perform identical registration actions simultaneously to
                    demonstrate PostgreSQL <code>SELECT FOR UPDATE</code> row-level locking!</p>
                <div style="background:var(--bg-main); padding: 1rem; border-radius: 0.5rem; margin-bottom: 2rem;">
                    <strong>Event:</strong> <span id="sim-event-title"></span>
                </div>

                <form onsubmit="handleSimulation(event)">
                    <input type="hidden" id="sim-event-id">
                    <div class="form-group">
                        <label>Number of Concurrent Users</label>
                        <input type="number" id="sim-users-count" value="100" min="1" max="1000">
                    </div>
                    <button type="submit" class="btn btn-danger">Launch Attack</button>
                </form>

                <div id="sim-results" class="sim-results hidden">
                    <h3 style="margin-bottom: 0.5rem; font-size: 1.1rem;">Live Simulation Output</h3>
                    <div class="results-grid">
                        <div class="stat-card">
                            <span class="stat-title">Spawned</span>
                            <span class="stat-value" id="res-total">0</span>
                        </div>
                        <div class="stat-card success">
                            <span class="stat-title">Confirmed</span>
                            <span class="stat-value" id="res-success">0</span>
                        </div>
                        <div class="stat-card waitlist">
                            <span class="stat-title">Waitlisted</span>
                            <span class="stat-value" id="res-waitlist">0</span>
                        </div>
                        <div class="stat-card fail">
                            <span class="stat-title">Failed</span>
                            <span class="stat-value" id="res-fail">0</span>
                        </div>
                    </div>
                    <div
                        style="text-align:center; margin-top: 1.5rem; padding: 1rem; background: rgba(37,99,235,0.1); border-radius: var(--radius-md);">
                        <span
                            style="color:var(--text-muted); font-size: 0.9rem; font-weight:600; text-transform:uppercase;">Final
                            Seats Remaining</span><br>
                        <strong id="res-seats" style="color:var(--primary); font-size:2rem; line-height:1;">0</strong>
                    </div>
                </div>
            </div>
        </div>

    </main>

    <script src="/static/app.js"></script>
</body>

</html>